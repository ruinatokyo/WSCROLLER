#include <stdlib.h>
#include <sys/bios.h>
#include <sys/key.h>

#define WAVE_SIZE 256

const signed char sine_table[WAVE_SIZE] = {
    0, 2, 5, 7, 10, 12, 15, 17, 20, 22, 24, 27, 29, 31, 33, 35,
    37, 39, 41, 43, 44, 46, 47, 49, 50, 51, 52, 53, 54, 55, 55, 56,
    56, 56, 56, 56, 55, 55, 54, 53, 52, 51, 50, 49, 47, 46, 44, 43,
    41, 39, 37, 35, 33, 31, 29, 27, 24, 22, 20, 17, 15, 12, 10, 7,
    5, 2, 0, -2, -5, -7, -10, -12, -15, -17, -20, -22, -24, -27, -29, -31,
    -33, -35, -37, -39, -41, -43, -44, -46, -47, -49, -50, -51, -52, -53, -54, -55,
    -55, -56, -56, -56, -56, -56, -55, -55, -54, -53, -52, -51, -50, -49, -47, -46,
    -44, -43, -41, -39, -37, -35, -33, -31, -29, -27, -24, -22, -20, -17, -15, -12,
    -10, -7, -5, -2, 0, 2, 5, 7, 10, 12, 15, 17, 20, 22, 24, 27,
    29, 31, 33, 35, 37, 39, 41, 43, 44, 46, 47, 49, 50, 51, 52, 53,
    54, 55, 55, 56, 56, 56, 56, 56, 55, 55, 54, 53, 52, 51, 50, 49,
    47, 46, 44, 43, 41, 39, 37, 35, 33, 31, 29, 27, 24, 22, 20, 17,
    15, 12, 10, 7, 5, 2, 0, -2, -5, -7, -10, -12, -15, -17, -20, -22,
    -24, -27, -29, -31, -33, -35, -37, -39, -41, -43, -44, -46, -47, -49, -50, -51,
    -52, -53, -54, -55, -55, -56, -56, -56, -56, -56, -55, -55, -54, -53, -52, -51,
    -50, -49, -47, -46, -44, -43, -41, -39, -37, -35, -33, -31, -29, -27, -24, -22
};

void main(int argc, char *argv[])
{
    BOOL loop = TRUE;
    int frame = 0;
	int d;
    int scroll_x = 0;
    int scroll_y = 0;
    int delay_time = 500;
    unsigned short keys;

    text_set_screen(SCREEN2);
    text_screen_init();
    text_put_string(0, 40, "Leviathan Alpha");

    do {
        keys = key_hit_check();

        if (keys & KEY_UP1)
            delay_time += 500;
        if (keys & KEY_DOWN1 && delay_time > 0)
            delay_time -= 500;
        if (keys & KEY_START)
            loop = FALSE;

        scroll_x--;
        scroll_y = sine_table[frame % WAVE_SIZE];

        screen_set_scroll(SCREEN2, scroll_x, scroll_y);

        for (d = 0; d < delay_time; d++);

        frame++;
    } while (loop);
}
